<!DOCTYPE html>
<!-- saved from url=(0097)file:///C:/Users/Suchat/OneDrive/Desktop/Project%20CHQ%20AIA/Report%20AIA/Report%20CHQ%20AIA.html -->
<html lang="th"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report CHQ AIA</title>
    <link href="bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
    <link rel="icon" type="image/png" href="favicon.png">
    
    <script src="xlsx.full.min.js"></script>
    <script src="JsBarcode.all.min.js"></script>
</head>
<body>
    <div class="container" style="max-width: 1000px;">

        <div class="ig-card">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div class="logo-title-container d-flex align-items-center">
                    <img src="./index_files/aia-logo.png" alt="AIA Logo" class="aia-logo">       
                    <h1 class="header-title-inline">Report CHQ AIA</h1>

                </div>
                <div class="barcode-container">
                    <svg id="barcode" width="172px" height="82px" x="0px" y="0px" viewBox="0 0 172 82" xmlns="http://www.w3.org/2000/svg" version="1.1" style="transform: translate(0,0)"></svg>

		        <button class="btn btn-info btn-sm text-white" type="button" onclick="window.print()">Print</button>
			<button class="btn btn-primary btn-sm" type="button" onclick="exportToText()" style="width: 80px;">Text</button>
        		<button class="btn btn-success btn-sm" type="button" onclick="exportToExcel()" style="width: 80px;">Excel</button>
                </div>
            </div>
            
            <div class="row g-3 align-items-end">
                <div class="col-md-2"> 
                    <label for="productionOrder" class="form-label">ใบสั่งเลขที่ผลิต</label>
                    <input type="text" class="form-control" id="productionOrder" placeholder="กรอกเลขที่..." oninput="generateBarcode()">
                </div>
                <div class="col-md-2"> <label for="inputDate" class="form-label">รอบงาน</label>
                    <input type="date" class="form-control" id="inputDate">
                </div>
                <div class="col-md-2"> <label for="startChequeNo" class="form-label">เลขเริ่มเช็ค</label>
                    <input type="number" class="form-control" id="startChequeNo">
                </div>
                <div class="col-md-2"> <label for="EndChequeNo" class="form-label">เลขจบเช็ค</label>
                    <div id="EndChequeNo" class="form-control">0</div>
                </div>
                <div class="col-md-1"> <label for="startBox" class="form-label">กล่องเริ่ม</label>
                    <input type="number" class="form-control" id="startBox">
                </div>
                <div class="col-md-1"> 
		     <label for="endBox" class="form-label">กล่องจบ</label>
                    <input type="number" class="form-control" id="endBox" readonly="">
                </div>
                <div class="col-md-1"> 
    		        <label for="totalBoxes" class="form-label">total</label>
    		        <input type="number" class="form-control" id="totalBoxes" readonly="">
		</div>
                
            </div>
        </div>

        <div class="ig-card">
            <div class="table-responsive">
                <table class="table table-striped table-sm" id="chequeDetailTable">
                    <thead>
                        <tr>
                            <th>Detail of Cheque Printing</th>
                            <th>Start Cheque No.</th>
                            <th>From Running No.</th>
                            <th>To Cheque No.</th>
                            <th class="green-bg">To Running No.</th>
                            <th>Status BATCH</th>
                            <th>Total of Cheque</th>
                            <th>Action</th> 
                        </tr>
                    </thead>
                    <tbody id="batchTableBody"><tr id="batch-row-1">
            <td style="font-weight: 500;">BCWSCHQ-TMB_BATCH 1</td>
            <td><input type="number" class="form-control form-control-sm text-end" id="startChq1" readonly="" value="0"></td>
            <td><input type="number" class="form-control form-control-sm text-end" id="fromRun1" readonly="" value="0"></td>
            <td><input type="number" class="form-control form-control-sm text-end" id="toChq1" readonly="" value="0"></td>
            <td class="green-bg"><input type="number" class="form-control form-control-sm text-end" id="toRun1" value=""></td>
            <td>
                <select class="form-select form-select-sm" id="status1">
                    <option value="Completed" selected="">COMPLETED</option>
                    <option value="Voided">VOIDED</option>
                </select>
            </td>
            <td><input type="number" class="form-control form-control-sm text-end" id="totalChq1" readonly="" value="0"></td>
            <td>
                <button class="btn btn-sm btn-info" onclick="addNewSubBatch(&#39;1&#39;)">เพิ่มข้อมูล</button>
                
            </td></tr></tbody>
                    <tfoot>
                        <tr style="font-weight: bold; background-color: #f8f9fa; border-top: 2px solid #dee2e6;">
                            <td colspan="6" class="text-end" style="padding: 10px;">Total of Cheque:</td>
                            <td class="text-end" style="padding: 10px; color: #0095f6; font-size: 1.1rem;">
                                <span id="grandTotalChqTable">0</span>
                            </td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
<div class="row text-center mb-4">
    <div class="col-md-4">
        <div class="p-3">
            <div class="text-secondary small mb-1">เลขเช็คลำดับต่อไป</div>
            <div id="nextChequeNo" class="summary-cheque-no">0</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="p-3">
            <div class="text-secondary small mb-1">กล่องที่ใช้ปัจจุบัน</div>
            <div id="currentBox" class="summary-box-no">0</div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="p-3">
            <div class="text-secondary small mb-1" style="color: #dc3545 !important; font-weight: bold;">กล่องถัดไป</div>
            <div id="nextBox" class="summary-box-no" style="color: #dc3545;">0</div>
        </div>
    </div>
</div>




    <footer class="text-center mt-1 mb-1 text-secondary small">
       Kaizen Basic by.สุชาติ นุ่มฝ้าย  | SIAMPRESS CO., LTD. 
    </footer>
        </div>

            </div>
        
    

    <div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ตัวอย่างไฟล์ Text (BATCHCHQ.txt)</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <pre><code id="previewContent" style="white-space: pre;"></code></pre>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                    <button type="button" class="btn btn-primary" onclick="exportToText();">Export &amp; ปิด</button>
                </div>
            </div>
        </div>
    </div>

    <script src="bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>


</body></html>
